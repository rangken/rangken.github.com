<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Effective Java 6장 열거형(enum)과 제네릭</title>
    <!-- SEO -->
    <meta name="description" content="열거형과 어노테이션 (30~37)">
    <meta name="keywords" content="Java, effective-java, Java"/>
    <meta name="author" content="Young.k">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://rangken.github.io/blog/2015/effective-java-5/">

    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/ko_KR/sdk.js#xfbml=1&appId=873345849376888&version=v2.0";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

    <!-- Google analytics -->
    <script>
  		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  		ga('create', 'UA-58142397-1', 'auto');
  		ga('send', 'pageview');
    </script>
    <script data-ad-client="ca-pub-9512351571435208" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>


  <body>

    <header class="site-header">
  <div class="wrapper">
    <img style="float: left" src="/img/jaeyoung.png" />
    <a class="site-title" href="/">
      <div style="float: left; margin-left: 30px;">YOUNG.K<div>
    </a>
    <div style="float: left; width:500px;">
      <a style="float: left;" class="post-link" href="http://rangken.gitbooks.io/nextersstudy1/content/">
        <h4 style="color:#ffffff;"> Study </h4>
      </a>
      <a style="float: left; margin-left: 10px;" class="post-link" href="http://nexters.github.io/Node-Study/">
        <h4 style="color:#ffffff;"> Node.js </h4>
      </a>
      <a style="float: left; margin-left: 10px;" class="post-link" href="http://rangken.gitbooks.io/javastudy/content/index.html">
        <h4 style="color:#ffffff;"> Effective-Java </h4>
      </a>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Effective Java 6장 열거형(enum)과 제네릭</h1>
    <p class="post-meta">Jan 15, 2015
      
	 </p>
  </header>

  <article class="post-content">
    <h2 id="열거형과-어노테이션-3037">열거형과 어노테이션 (30~37)</h2>
<ul>
  <li>Java 에서 열거 자료형(enum type) 은 참조 자료형이다.</li>
</ul>

<h3 id="item30--int-상수-대신-enum을-사용하라">ITEM30 : int 상수 대신 enum을 사용하라</h3>
<ul>
  <li>열거 자료형(enumerated type)은 고정 개수의 상수들로 값이 구성되는 자료형</li>
  <li>int 대신 enum 을 사용하면 공간적 시간적 손해를 보긴핮만 성능면에서 비등하다</li>
  <li>enum 은 가독성이 좋고 안전하며 강력함.</li>
  <li>
    <p>생성자나 멤버가 필요없으나 데이터 또는 그데이터에 관계된 메서드를 추가해서 기능을 향상시킨 enum 도 많다!</p>
  </li>
  <li>int enum 패턴 : <em>사용하면안된다</em></li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">APPLE_FUJI</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">APPLE_PIPPIN</span> <span class="o">=</span><span class="mi">1</span><span class="o">;</span>
<span class="o">...</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="o">(</span><span class="no">APPLE_FUJI</span> <span class="o">-</span> <span class="no">ORANGE_TEMPLE</span><span class="o">)</span> <span class="o">/</span> <span class="no">APPLE_PIPPIN</span><span class="o">;</span> <span class="c1">// 변수가 섞임</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>단점
    <ul>
      <li>상수를 사용하는 클라이언트 코드와 함께 컴파일됨, 값이 변경되면 다시 컴파일 다시해야함</li>
      <li>크기를 알아낼수 없음</li>
      <li>디버깅이 불편함
        <ul>
          <li>String enum 패턴으로 해결 가능하지만 <em>더더욱 최악의방법</em></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Apple</span> <span class="o">{</span> <span class="no">FUJI</span><span class="o">,</span> <span class="no">PIPPIN</span><span class="o">,</span> <span class="no">GRANNY_SMITH</span><span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>enum
    <ul>
      <li>C/C++/C# 언어가 제공하는 enum 이랑 다름, <em>다른언어에서는 단순 int 값이다</em>
        <ul>
          <li>Java 에서는 <strong>참조 자료형</strong></li>
        </ul>
      </li>
      <li>enum 자료형은 public static final 필드 형태로 제공하는것</li>
      <li>클라이언트가 접근할수 있는 생성자가 없다. 계승 확장 불가능</li>
      <li>컴파일 시점에 형 안정성 제공한다! 같은 enum형 에서 비교연산자 == 가 가능하다!</li>
      <li>같은 이름의 상수가 공존 가능.</li>
      <li>enum 형은 toString 메서드를 호출 가능해서 문자열로 쉽게 변경 가능!</li>
      <li>Object 에 정의된 메서드들이 포함되어있다.</li>
      <li>Comparable, Serializable 인터페이스 구현되어있다!</li>
    </ul>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Planet</span> <span class="o">{</span>
     <span class="no">MERCURY</span> <span class="o">(</span><span class="mf">3.302</span><span class="n">e</span><span class="o">+</span><span class="mi">23</span><span class="o">,</span> <span class="mf">2.439e6</span><span class="o">),</span>
     <span class="no">VENUS</span> <span class="o">.</span>
     <span class="no">EARTH</span>
     <span class="no">MARS</span>
     <span class="no">JUPITER</span>
     <span class="no">SATURE</span>
     <span class="no">URANUS</span>
     <span class="no">NEPTUNE</span>
    
     <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">mass</span><span class="o">;</span> <span class="c1">// 킬로그램 단위</span>
     <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">radius</span><span class="o">;</span>
     <span class="kd">private</span> <span class="kd">final</span> <span class="n">dobule</span> <span class="n">surfaceGravity</span><span class="o">;</span>
    
     <span class="c1">// MERCURY (3.302e+23, 2.439e6) 처럼 두개의 값을 초기화 하는 생성자</span>
     <span class="nc">Planet</span><span class="o">(</span><span class="kt">double</span> <span class="n">mass</span><span class="o">,</span> <span class="kt">double</span> <span class="n">radius</span><span class="o">){</span>
          <span class="k">this</span><span class="o">.</span><span class="na">mass</span> <span class="o">=</span> <span class="n">mass</span><span class="o">;</span>
          <span class="k">this</span><span class="o">.</span><span class="na">radius</span> <span class="o">=</span> <span class="n">radius</span><span class="o">;</span>
          <span class="n">surfaceGravity</span> <span class="o">=</span> <span class="no">G</span> <span class="o">*</span> <span class="n">mass</span> <span class="o">/</span> <span class="o">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">radius</span><span class="o">);</span>
     <span class="o">}</span>
    
     <span class="c1">// 접근자</span>
     <span class="kd">public</span> <span class="kt">double</span> <span class="nf">mass</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">mass</span><span class="o">;</span> <span class="o">}</span>
     <span class="o">...</span>
    
     <span class="c1">// 추가 메서드</span>
     <span class="kd">public</span> <span class="kt">double</span> <span class="nf">surcfaceWight</span><span class="o">(</span><span class="kt">double</span> <span class="n">mass</span><span class="o">){</span>
          <span class="k">return</span> <span class="n">mass</span> <span class="o">*</span> <span class="n">surfaceGravity</span><span class="o">;</span> <span class="c1">// F = ma</span>
     <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// 사용</span>
<span class="kt">double</span> <span class="n">mass</span> <span class="o">=</span> <span class="n">earthWeight</span> <span class="o">/</span> <span class="nc">Planet</span><span class="o">.</span><span class="na">EARTH</span><span class="o">.</span><span class="na">surfaceGravity</span><span class="o">();</span>
<span class="c1">// values 라는 static 함수존재한다! 이외에도 기본 제공함수들이 많음!</span>
<span class="k">for</span><span class="o">(</span><span class="nc">Planet</span> <span class="n">p</span> <span class="o">:</span> <span class="nc">Planet</span><span class="o">.</span><span class="na">values</span><span class="o">()</span> <span class="o">)</span>
     <span class="n">p</span><span class="o">.</span><span class="na">surfaceWeight</span><span class="o">(</span><span class="n">mass</span><span class="o">)</span>
    
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li><strong>enum 상수에 데이터를 넣으려면 객체 필드를 선언하고 생성자를 통해 받은 데이터를 그 필드에 저장하면 된다!</strong></li>
  <li>enum 도 클라이언트에게 공개할 이유가 없다면 private 나 package-private로 선언해야 한다.</li>
  <li>
    <p>공개한다면 최상위 public 클래스로 생성하거나, 최상위 클래스의 멤버 클래스로 선언하면 된다.</p>
  </li>
  <li><strong>switch 문 대신 상수별 메서드를 구현해야 한다!</strong></li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Operation</span> <span class="o">{</span>
     <span class="c1">// switch 로 +,-,*,/ 일때 분기해서 처리하는것보다 이런식으로 처리하는게 확장성에 좋다.</span>
     <span class="c1">// 새로운 ^ 과 같은 값이 추가된다면 switch 로 하면 문제없이 컴파일 되지만 abstract 방식을 사용하면 컴파일 에러 발생!</span>
     <span class="no">PLUS</span><span class="o">(</span><span class="s">"+"</span><span class="o">)</span> <span class="o">{</span>
          <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
               <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;</span>
          <span class="o">}</span>
     <span class="o">},</span>
     <span class="no">MINUS</span><span class="o">(</span><span class="s">"-"</span><span class="o">)</span> <span class="o">{</span>
          <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
               <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="o">;</span>
          <span class="o">}</span>
     <span class="o">},</span>
     <span class="no">TIMES</span><span class="o">(</span><span class="s">"*"</span><span class="o">)</span> <span class="o">{</span>
          <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
               <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">;</span>
          <span class="o">}</span>
     <span class="o">},</span>
     <span class="no">DIVIDE</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span> <span class="o">{</span>
          <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
               <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="o">;</span>
          <span class="o">}</span>
     <span class="o">};</span>
     <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">symbol</span><span class="o">;</span>

     <span class="nc">Operation</span><span class="o">(</span><span class="nc">String</span> <span class="n">symbol</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">this</span><span class="o">.</span><span class="na">symbol</span> <span class="o">=</span> <span class="n">symbol</span><span class="o">;</span>
     <span class="o">}</span>

     <span class="nd">@Override</span>
     <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">symbol</span><span class="o">;</span>
     <span class="o">}</span>

     <span class="kd">abstract</span> <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">);</span>

     <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Operation</span><span class="o">&gt;</span> <span class="n">stringToEnum</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Operation</span><span class="o">&gt;();</span>
     <span class="kd">static</span> <span class="o">{</span>
          <span class="c1">// Operation 생성자 안에서 stringToEnum 에 값을 넣으면 NullPointerException 이 난다.</span>
          <span class="c1">// enum 생성자안에서는 enum 의 static 필드를 접근할수 없다. (컴파일 시점에서 상수면 접근 가능)</span>
          <span class="c1">// 생성자가 실행될때 static 필드는 초기화된 상태가 아니기 떄문!</span>
          <span class="k">for</span> <span class="o">(</span><span class="nc">Operation</span> <span class="n">op</span> <span class="o">:</span> <span class="n">values</span><span class="o">())</span>
               <span class="n">stringToEnum</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">op</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">op</span><span class="o">);</span>
     <span class="o">}</span>

     <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Operation</span> <span class="nf">fromString</span><span class="o">(</span><span class="nc">String</span> <span class="n">symbol</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">stringToEnum</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">symbol</span><span class="o">);</span>
     <span class="o">}</span>

     <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
          <span class="kt">double</span> <span class="n">x</span> <span class="o">=</span> <span class="nc">Double</span><span class="o">.</span><span class="na">parseDouble</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
          <span class="kt">double</span> <span class="n">y</span> <span class="o">=</span> <span class="nc">Double</span><span class="o">.</span><span class="na">parseDouble</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]);</span>
          <span class="k">for</span> <span class="o">(</span><span class="nc">Operation</span> <span class="n">op</span> <span class="o">:</span> <span class="nc">Operation</span><span class="o">.</span><span class="na">values</span><span class="o">())</span>
               <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%f %s %f = %f%n"</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">op</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">op</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">));</span>
     <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>enum 값에 따라 처리하는 방법2</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="code"><pre><span class="kd">enum</span> <span class="nc">PayrollDay</span> <span class="o">{</span>
     <span class="no">MONDAY</span><span class="o">(</span><span class="nc">PayType</span><span class="o">.</span><span class="na">WEEKDAY</span><span class="o">),</span> <span class="no">TUESDAY</span><span class="o">(</span><span class="nc">PayType</span><span class="o">.</span><span class="na">WEEKDAY</span><span class="o">),</span> <span class="no">WEDNESDAY</span><span class="o">(</span>
               <span class="nc">PayType</span><span class="o">.</span><span class="na">WEEKDAY</span><span class="o">),</span> <span class="no">THURSDAY</span><span class="o">(</span><span class="nc">PayType</span><span class="o">.</span><span class="na">WEEKDAY</span><span class="o">),</span> <span class="no">FRIDAY</span><span class="o">(</span><span class="nc">PayType</span><span class="o">.</span><span class="na">WEEKDAY</span><span class="o">),</span> <span class="no">SATURDAY</span><span class="o">(</span>
               <span class="nc">PayType</span><span class="o">.</span><span class="na">WEEKEND</span><span class="o">),</span> <span class="no">SUNDAY</span><span class="o">(</span><span class="nc">PayType</span><span class="o">.</span><span class="na">WEEKEND</span><span class="o">);</span>

     <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PayType</span> <span class="n">payType</span><span class="o">;</span>

     <span class="nc">PayrollDay</span><span class="o">(</span><span class="nc">PayType</span> <span class="n">payType</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">this</span><span class="o">.</span><span class="na">payType</span> <span class="o">=</span> <span class="n">payType</span><span class="o">;</span>
     <span class="o">}</span>

     <span class="kt">double</span> <span class="nf">pay</span><span class="o">(</span><span class="kt">double</span> <span class="n">hoursWorked</span><span class="o">,</span> <span class="kt">double</span> <span class="n">payRate</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">payType</span><span class="o">.</span><span class="na">pay</span><span class="o">(</span><span class="n">hoursWorked</span><span class="o">,</span> <span class="n">payRate</span><span class="o">);</span>
     <span class="o">}</span>

     <span class="kd">private</span> <span class="kd">enum</span> <span class="nc">PayType</span> <span class="o">{</span>
          <span class="no">WEEKDAY</span> <span class="o">{</span>
               <span class="kt">double</span> <span class="nf">overtimePay</span><span class="o">(</span><span class="kt">double</span> <span class="n">hours</span><span class="o">,</span> <span class="kt">double</span> <span class="n">payRate</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">hours</span> <span class="o">&lt;=</span> <span class="no">HOURS_PER_SHIFT</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="o">(</span><span class="n">hours</span> <span class="o">-</span> <span class="no">HOURS_PER_SHIFT</span><span class="o">)</span>
                              <span class="o">*</span> <span class="n">payRate</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>
               <span class="o">}</span>
          <span class="o">},</span>
          <span class="no">WEEKEND</span> <span class="o">{</span>
               <span class="kt">double</span> <span class="nf">overtimePay</span><span class="o">(</span><span class="kt">double</span> <span class="n">hours</span><span class="o">,</span> <span class="kt">double</span> <span class="n">payRate</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">hours</span> <span class="o">*</span> <span class="n">payRate</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>
               <span class="o">}</span>
          <span class="o">};</span>
          <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">HOURS_PER_SHIFT</span> <span class="o">=</span> <span class="mi">8</span><span class="o">;</span>
         
          <span class="c1">// 추상 메소드! 확장성에 좋다!</span>
          <span class="kd">abstract</span> <span class="kt">double</span> <span class="nf">overtimePay</span><span class="o">(</span><span class="kt">double</span> <span class="n">hrs</span><span class="o">,</span> <span class="kt">double</span> <span class="n">payRate</span><span class="o">);</span>

          <span class="kt">double</span> <span class="nf">pay</span><span class="o">(</span><span class="kt">double</span> <span class="n">hoursWorked</span><span class="o">,</span> <span class="kt">double</span> <span class="n">payRate</span><span class="o">)</span> <span class="o">{</span>
               <span class="kt">double</span> <span class="n">basePay</span> <span class="o">=</span> <span class="n">hoursWorked</span> <span class="o">*</span> <span class="n">payRate</span><span class="o">;</span>
               <span class="k">return</span> <span class="n">basePay</span> <span class="o">+</span> <span class="n">overtimePay</span><span class="o">(</span><span class="n">hoursWorked</span><span class="o">,</span> <span class="n">payRate</span><span class="o">);</span>
          <span class="o">}</span>
     <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<h3 id="item31--ordinal-대신-객체-필드를-사용하라">ITEM31 : ordinal 대신 객체 필드를 사용하라</h3>
<ul>
  <li>모든 enum 에는 ordinal() 이라는 메서드가 있음</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="n">num</span> <span class="nc">Ensemble</span> <span class="o">{</span>
    <span class="no">SOLO</span><span class="o">,</span> <span class="no">DUET</span><span class="o">,</span> <span class="no">TRIO</span><span class="o">,</span> <span class="no">QUATET</span><span class="o">,</span> <span class="no">QUINTET</span><span class="o">,..</span>
    
    <span class="c1">// 절대 만들어서는 안되는 메소드, 타입을 추가하거나 제외할 경우에 매우 취약하다.</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">numberOfMusicians</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">ordinal</span><span class="o">()</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;}</span> 
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>
    <p>ENUM 형 값에 명시적으로 값을 줄수도 있다. 이런경우에 값을 바꿀경우 <em>numberOfMusicians()</em> 함수가 외부에 종속적이므로 문제가 발생할수 있다.</p>
  </li>
  <li>
    <p>ENUM 상수에 연계되는 값을 <em>ordinal</em> 을 사용해 표현하지 말아라!!! 그런값이 필요하다면 그대신 객체 필드에 저장해야 한다.</p>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Ensemble</span> <span class="o">{</span>
    <span class="c1">// 명시적으로 enum 숫자 정해줌</span>
    <span class="no">SOLO</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="no">DUET</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span> <span class="no">TRIO</span><span class="o">(</span><span class="mi">3</span><span class="o">),</span> <span class="no">QUARTET</span><span class="o">(</span><span class="mi">4</span><span class="o">),</span> <span class="no">QUINTET</span><span class="o">(</span><span class="mi">5</span><span class="o">),</span> <span class="no">SEXTET</span><span class="o">(</span><span class="mi">6</span><span class="o">),</span> <span class="no">SEPTET</span><span class="o">(</span><span class="mi">7</span><span class="o">),</span> <span class="no">OCTET</span><span class="o">(</span>
            <span class="mi">8</span><span class="o">),</span> <span class="no">DOUBLE_QUARTET</span><span class="o">(</span><span class="mi">8</span><span class="o">),</span> <span class="no">NONET</span><span class="o">(</span><span class="mi">9</span><span class="o">),</span> <span class="no">DECTET</span><span class="o">(</span><span class="mi">10</span><span class="o">),</span> <span class="no">TRIPLE_QUARTET</span><span class="o">(</span><span class="mi">12</span><span class="o">);</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">numberOfMusicians</span><span class="o">;</span>
    
    <span class="c1">// 생성 할때 사이즈 받는다!</span>
    <span class="nc">Ensemble</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">numberOfMusicians</span> <span class="o">=</span> <span class="n">size</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// 객체 필드를 리턴함</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">numberOfMusicians</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">numberOfMusicians</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li><em>ordinal()</em> 함수 자체는 <em>EnumSet</em> <em>EnumMap</em> 처럼 일반적인 용도의 enum 기반 자료구조에서 사용할 목적으로 설계한 메서드 이다.
    <ul>
      <li><em>EnumSet</em> : 비트 필드 대신에 사용해야하는 자료구조
        <ul>
          <li><strong>EnumSet.of(Ensemble.SOLO,Ensemble,DUET)</strong>
  _ <em>EnumMap</em> : 맵에 키값으로 enum 필드를 사용할수 있는 자료구조</li>
          <li><strong>EnumMap&lt;Ensemble, String&gt; map = new ..</strong></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="item32--비트-필드bit-field-대신-enumset을-사용하라">ITEM32 : 비트 필드(bit field) 대신 EnumSet을 사용하라</h3>
<ul>
  <li>열거 자료형 원소들을 집합에 사용할때 C 스타일로 int eunm 패턴에 2의 거듭제곱 값을 대입해서 사용했다</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Text</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">STYLE_BOLD</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="o">;</span> <span class="c1">//1</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">STYLE_ITALIC</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">;</span> <span class="c1">// 2</span>
    <span class="o">...</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">applyStyle</span><span class="o">(</span><span class="kt">int</span> <span class="n">styles</span><span class="o">){</span> <span class="o">..}</span>
<span class="o">}</span>
<span class="n">text</span><span class="o">.</span><span class="na">appleStyles</span><span class="o">(</span><span class="no">STYLE_BOLD</span> <span class="o">|</span> <span class="no">STYLE_ITALIC</span><span class="o">);</span> <span class="c1">// 원소들을 집합으로 사용하기 위해서 | 비트 연산을 이용</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>집합을 비트 필드로 나타내면 비트 단위 산술 연산을 통해 합집합 교집합 등의 집합 연산도 효울적으로 실행할수 있다. <strong>하지만 여러 단점이 존재함!!</strong>
    <ul>
      <li>상수를 출력해도 이해하기가 어렵다.</li>
      <li>비트 필드에 포함된 모든 요소를 순차적으로 살펴보기도 어렵다.</li>
    </ul>
  </li>
  <li>대신에 <strong>java.util.EnumSet</strong> 을 사용하면 된다.
    <ul>
      <li>Set 인터페이스을 구현해서 Set 이 제공하는 풍부한 기능을 그대로 사용할수 있다.</li>
      <li>형 안정성, 상호운영성(다른 구조의 Set도 EnumSet으로 바꿀수 있다.) 을 제공함!</li>
      <li>EnumSet 내부 구현 자체는 bit vector 로 되어있다. enum 값 갯수가 64개 이하이면 long 값 하나만 사용할수 있다.</li>
    </ul>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Text</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Style</span> <span class="o">{</span>
        <span class="no">BOLD</span><span class="o">,</span> <span class="no">ITALIC</span><span class="o">,</span> <span class="no">UNDERLINE</span><span class="o">,</span> <span class="no">STRIKETHROUGH</span>
    <span class="o">}</span>
    <span class="c1">// EnumSet 이 아니라 Set 으로 사용가능하게 했다. </span>
    <span class="c1">// 인터페이스를 자료형으로 쓰므로 인해서 상호 운영성을 얻을수 있다.</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">applyStyles</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Style</span><span class="o">&gt;</span> <span class="n">styles</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Body goes here</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Text</span> <span class="n">text</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Text</span><span class="o">();</span>
        <span class="c1">// EnumSet 사용!</span>
        <span class="n">text</span><span class="o">.</span><span class="na">applyStyles</span><span class="o">(</span><span class="nc">EnumSet</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="nc">Style</span><span class="o">.</span><span class="na">BOLD</span><span class="o">,</span> <span class="nc">Style</span><span class="o">.</span><span class="na">ITALIC</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>열거 자료형을 집합에 사용해야 한다고 해서 비트 필드로 구현하지마라!!!</li>
  <li>자바1.6 기준으로 EnumSet 은 변경 불가능한 객체를 만들수 없다.
    <ul>
      <li><em>이후 변경될것이다.</em></li>
      <li>Java 1.7 에서도 불가능하다. <strong>Guava 를 사용하면 가능하다</strong></li>
    </ul>
  </li>
</ul>

<h3 id="item33--ordinal을-배열-첨자로-사용하는-대신-enummap을-이용하라">ITEM33 : ordinal을 배열 첨자로 사용하는 대신 EnumMap을 이용하라</h3>
<ul>
  <li>ordinal 을 사용해 여러 자바 자료구조와 Enum 형을 맵핑 시키는 일은 하면 안된다.
    <ul>
      <li>형 안정성을 제공하지 못하고, 틀린값을 쓰게 되면 이상한 짓을 하게 되거나 해당 Index 를 넘어갈경우 <em>ArrayIndexOutOfBoundsExeception</em> 을 만들수도 있다.</li>
    </ul>
  </li>
  <li>java.util.EnumMap 을 사용하여 enum 상수를 키로 사용하는 맵을 만들자!</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Herb</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Type</span> <span class="o">{</span>
        <span class="no">ANNUAL</span><span class="o">,</span> <span class="no">PERENNIAL</span><span class="o">,</span> <span class="no">BIENNIAL</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Type</span> <span class="n">type</span><span class="o">;</span>

    <span class="nc">Herb</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Type</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">type</span> <span class="o">=</span> <span class="n">type</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Herb</span><span class="o">[]</span> <span class="n">garden</span> <span class="o">=</span> <span class="o">{</span> <span class="k">new</span> <span class="nc">Herb</span><span class="o">(</span><span class="s">"Basil"</span><span class="o">,</span> <span class="nc">Type</span><span class="o">.</span><span class="na">ANNUAL</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Herb</span><span class="o">(</span><span class="s">"Carroway"</span><span class="o">,</span> <span class="nc">Type</span><span class="o">.</span><span class="na">BIENNIAL</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Herb</span><span class="o">(</span><span class="s">"Dill"</span><span class="o">,</span> <span class="nc">Type</span><span class="o">.</span><span class="na">ANNUAL</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Herb</span><span class="o">(</span><span class="s">"Lavendar"</span><span class="o">,</span> <span class="nc">Type</span><span class="o">.</span><span class="na">PERENNIAL</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Herb</span><span class="o">(</span><span class="s">"Parsley"</span><span class="o">,</span> <span class="nc">Type</span><span class="o">.</span><span class="na">BIENNIAL</span><span class="o">),</span>
                <span class="k">new</span> <span class="nf">Herb</span><span class="o">(</span><span class="s">"Rosemary"</span><span class="o">,</span> <span class="nc">Type</span><span class="o">.</span><span class="na">PERENNIAL</span><span class="o">)</span> <span class="o">};</span>

        <span class="c1">// Enum 형 Herb.Type 을 키로 사용!!</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Herb</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Herb</span><span class="o">&gt;&gt;</span> <span class="n">herbsByType</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EnumMap</span><span class="o">&lt;</span><span class="nc">Herb</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Herb</span><span class="o">&gt;&gt;(</span>
                <span class="nc">Herb</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Herb</span><span class="o">.</span><span class="na">Type</span> <span class="n">t</span> <span class="o">:</span> <span class="nc">Herb</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">values</span><span class="o">())</span>
            <span class="n">herbsByType</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">t</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">Herb</span><span class="o">&gt;());</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Herb</span> <span class="n">h</span> <span class="o">:</span> <span class="n">garden</span><span class="o">)</span>
            <span class="n">herbsByType</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">h</span><span class="o">.</span><span class="na">type</span><span class="o">).</span><span class="na">add</span><span class="o">(</span><span class="n">h</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">herbsByType</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>내부적으로는 <em>ordinal</em> 을 사용한다. 명시적으로 <em>ordinal</em> 을 사용하는것과 성능상에 크게 차이가 없다.</li>
  <li><strong>new EnumMap&lt;Herb.Type, Set&lt;Herb&gt;&gt;(
              Herb.Type.class)</strong>
    <ul>
      <li>생성자에 키의 자료형을 나타내는 Class 객체를 인자로 받는다!.</li>
      <li>Class 객체를 한정적 자료형 토큰으로 사용해서 실행 시점에서 제네릭 자료형 정보를 제공한다.
        <ul>
          <li>EnumMap 은 내부적으로 <strong>new Object[length]</strong> 형식으로 되어있다. 타입을 체크하고 리턴하기 위해서는 타입정보를 알아야한다.</li>
          <li>EnumSet 은 static factory 로 생성되서 타입 정보를 넘기지 않는거 같지만 내부적으로 <em>e.getDeclaringClass()</em> 를 가져와서 타입정보를 가져온다. 처음 생성시에 타입을 넘기므로 EnumMap 처럼 생성할때 타입정보를 넘기지 않아도 된다.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>액체 고체 기체 변화를 나타내는 Enum 형
    <ul>
      <li>표현해야 하는 관계가 다차원적이라면 <strong>EnumMap&lt;… , EnumMap&lt;…&gt;&gt; 과 같이 사용하면 된다.</strong></li>
    </ul>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Phase</span> <span class="o">{</span>
    <span class="no">SOLID</span><span class="o">,</span> <span class="no">LIQUID</span><span class="o">,</span> <span class="no">GAS</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Transition</span> <span class="o">{</span>
        <span class="no">MELT</span><span class="o">(</span><span class="no">SOLID</span><span class="o">,</span> <span class="no">LIQUID</span><span class="o">),</span> <span class="no">FREEZE</span><span class="o">(</span><span class="no">LIQUID</span><span class="o">,</span> <span class="no">SOLID</span><span class="o">),</span> <span class="no">BOIL</span><span class="o">(</span><span class="no">LIQUID</span><span class="o">,</span> <span class="no">GAS</span><span class="o">),</span> <span class="no">CONDENSE</span><span class="o">(</span>
                <span class="no">GAS</span><span class="o">,</span> <span class="no">LIQUID</span><span class="o">),</span> <span class="no">SUBLIME</span><span class="o">(</span><span class="no">SOLID</span><span class="o">,</span> <span class="no">GAS</span><span class="o">),</span> <span class="no">DEPOSIT</span><span class="o">(</span><span class="no">GAS</span><span class="o">,</span> <span class="no">SOLID</span><span class="o">);</span>

        <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Phase</span> <span class="n">src</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Phase</span> <span class="n">dst</span><span class="o">;</span>

        <span class="nc">Transition</span><span class="o">(</span><span class="nc">Phase</span> <span class="n">src</span><span class="o">,</span> <span class="nc">Phase</span> <span class="n">dst</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">src</span> <span class="o">=</span> <span class="n">src</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">dst</span> <span class="o">=</span> <span class="n">dst</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="c1">// 변경 테이블을 맵으로 만든다.</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Phase</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Phase</span><span class="o">,</span> <span class="nc">Transition</span><span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EnumMap</span><span class="o">&lt;</span><span class="nc">Phase</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Phase</span><span class="o">,</span> <span class="nc">Transition</span><span class="o">&gt;&gt;(</span>
                <span class="nc">Phase</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="kd">static</span> <span class="o">{</span>
            <span class="c1">// 가능한 변화를 초기화</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Phase</span> <span class="n">p</span> <span class="o">:</span> <span class="nc">Phase</span><span class="o">.</span><span class="na">values</span><span class="o">())</span>
                <span class="n">m</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="k">new</span> <span class="nc">EnumMap</span><span class="o">&lt;</span><span class="nc">Phase</span><span class="o">,</span> <span class="nc">Transition</span><span class="o">&gt;(</span><span class="nc">Phase</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Transition</span> <span class="n">trans</span> <span class="o">:</span> <span class="nc">Transition</span><span class="o">.</span><span class="na">values</span><span class="o">())</span>
                <span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">trans</span><span class="o">.</span><span class="na">src</span><span class="o">).</span><span class="na">put</span><span class="o">(</span><span class="n">trans</span><span class="o">.</span><span class="na">dst</span><span class="o">,</span> <span class="n">trans</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Transition</span> <span class="nf">from</span><span class="o">(</span><span class="nc">Phase</span> <span class="n">src</span><span class="o">,</span> <span class="nc">Phase</span> <span class="n">dst</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">src</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="n">dst</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Phase</span> <span class="n">src</span> <span class="o">:</span> <span class="nc">Phase</span><span class="o">.</span><span class="na">values</span><span class="o">())</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Phase</span> <span class="n">dst</span> <span class="o">:</span> <span class="nc">Phase</span><span class="o">.</span><span class="na">values</span><span class="o">())</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">src</span> <span class="o">!=</span> <span class="n">dst</span><span class="o">)</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%s to %s : %s %n"</span><span class="o">,</span> <span class="n">src</span><span class="o">,</span> <span class="n">dst</span><span class="o">,</span>
                            <span class="nc">Transition</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">src</span><span class="o">,</span> <span class="n">dst</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<h3 id="item34--확장-가능한-enum을-만들어야-한다면-인터페이스를-이용하라">ITEM34 : 확장 가능한 enum을 만들어야 한다면 인터페이스를 이용하라</h3>
<ul>
  <li>ENUM 형은 기본적으로 계승이 안된다!!
    <ul>
      <li>계승이 되는거처럼 흉내 내려면 인터페이스를 만들어서 같은 인터페이스를 implements 할수 있다.</li>
    </ul>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Operation</span> <span class="o">{</span>
    <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">);</span>
<span class="o">}</span>
<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">BasicOperation</span> <span class="kd">implements</span> <span class="nc">Operation</span> <span class="o">{</span>
    <span class="no">PLUS</span><span class="o">(</span><span class="s">"+"</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">MINUS</span><span class="o">(</span><span class="s">"-"</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">TIMES</span><span class="o">(</span><span class="s">"*"</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">DIVIDE</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">};</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">symbol</span><span class="o">;</span>

    <span class="nc">BasicOperation</span><span class="o">(</span><span class="nc">String</span> <span class="n">symbol</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">symbol</span> <span class="o">=</span> <span class="n">symbol</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">symbol</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="code"><pre><span class="c1">// BasicOperation 처럼 Operation 구현</span>
<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">ExtendedOperation</span> <span class="kd">implements</span> <span class="nc">Operation</span> <span class="o">{</span>
    <span class="no">EXP</span><span class="o">(</span><span class="s">"^"</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nc">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">},</span>
    <span class="no">REMAINDER</span><span class="o">(</span><span class="s">"%"</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">double</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="n">y</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">};</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">symbol</span><span class="o">;</span>

    <span class="nc">ExtendedOperation</span><span class="o">(</span><span class="nc">String</span> <span class="n">symbol</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">symbol</span> <span class="o">=</span> <span class="n">symbol</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">symbol</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">x</span> <span class="o">=</span> <span class="nc">Double</span><span class="o">.</span><span class="na">parseDouble</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="kt">double</span> <span class="n">y</span> <span class="o">=</span> <span class="nc">Double</span><span class="o">.</span><span class="na">parseDouble</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]);</span>
        <span class="n">test</span><span class="o">(</span><span class="nc">ExtendedOperation</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span> 
        <span class="n">test2</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="nc">ExtendedOperation</span><span class="o">.</span><span class="na">values</span><span class="o">()),</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Enum 형을 테스트 하기 위해 한정적 자료형 토큰을 넘기는 방법 </span>
    <span class="c1">// Class 에 getEnumConstants 를 사용해 가능한 Operation 을 가져올수 있다.</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span> <span class="kd">extends</span> <span class="nc">Enum</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="nc">Operation</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">opSet</span><span class="o">,</span>
            <span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Operation</span> <span class="n">op</span> <span class="o">:</span> <span class="n">opSet</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">())</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%f %s %f = %f%n"</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">op</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">op</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">// Enum 형을 테스트 하기 위해  한정적 와일드 카드 자료형을 사용</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">test2</span><span class="o">(</span><span class="nc">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Operation</span><span class="o">&gt;</span> <span class="n">opSet</span><span class="o">,</span> <span class="kt">double</span> <span class="n">x</span><span class="o">,</span>
            <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Operation</span> <span class="n">op</span> <span class="o">:</span> <span class="n">opSet</span><span class="o">)</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%f %s %f = %f%n"</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">op</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">op</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>_&lt;T extends Enum<T> &amp; Operation&gt; void test(Class<T> opSet, double x, double y)_
</T></T>    <ul>
      <li>자료형의 class 리터럴을 사용, class 리터럴은 한정적 자료형 토큰 역활을 한다.</li>
      <li><strong>&lt;T extends Enum&lt;T&gt; &amp; Operation&gt;</strong> : Class 객체가 나타내는 자료형이 enum 자료형인 동시에 Opertion 하위 자료형이 되어야한다. (Enum 자체는 상속이 안되고 같은 interface 를 상속하는 방식이므로 이런 한정적 방법이 필요함)</li>
    </ul>
  </li>
  <li><em>void test2(Collection&lt;? extends Operation&gt; opSet, double x, double y)</em>
    <ul>
      <li>EnumSet 이나 EnumMap 을 사용할수 있는 유연성이 가능하다.</li>
      <li><strong>하지만 한정적 와일드 카드 자료형 특성상 특정 operation을 직접 수행할수는 없다.</strong>, 실제로 연산을 수행할수 있으르면 한정적 자료형 토큰으로 사용하자!</li>
    </ul>
  </li>
</ul>

<h3 id="item35--작명-패턴-대신-어노테이션을-사용하라">ITEM35 : 작명 패턴 대신 어노테이션을 사용하라</h3>
<ul>
  <li>자바 1.5 이전에는(어노테이션이 없을때) 도구나 프레임워크가 특별히 취급해야 되면 작명패턴을 사용했다
    <ul>
      <li>JUnit 은 테스트 이름을 test 로 시작하게 했다.</li>
      <li>이름을 잘못 입력하면 문제가 발생하거나 무시해서 문제가 생김..</li>
      <li>프로그램 요소에 인자를 전달할 방법이없다.</li>
    </ul>
  </li>
  <li>주석 타입 정의</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="kn">import</span> <span class="nn">java.lang.annotation.ElementType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.RetentionPolicy</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>

<span class="c1">// 어노테이션 사용</span>
<span class="c1">// 메타 주석</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span> <span class="c1">// Test 주석이 런타임시에 존속되어야 한다</span>
<span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">)</span> <span class="c1">// 메소드 선언시에만 적합하다.</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Test</span> <span class="o">{</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>
    <p>메타 주석 : 주석 타입 선언에 나온 주석</p>
  </li>
  <li>
    <p>특정 예외를 발생 시키는 경우에 한해서 테스트가 성공하도록 만들기</p>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">)</span> 
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">ExceptionTest</span> <span class="o">{</span>
    <span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Exception</span><span class="o">&gt;</span> <span class="nf">value</span><span class="o">();</span> <span class="c1">// 한개의 타입만 받는다.</span>
    <span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Exception</span><span class="o">&gt;[]</span> <span class="nf">value</span><span class="o">();</span> <span class="c1">// 여러개의 타입을 받는다.</span>
    <span class="cm">/*
    Class&lt;? extends Exception&gt;[] excTypes = m.getAnnotation(
                            ExceptionTest.class).value(); // 처럼 사용
    */</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li><em>Class&lt;? extends Exception&gt;</em>
    <ul>
      <li>Exception 예외 클래스에서 상속받은 어떤 클래스의 class 객체</li>
      <li>이주석 사용자가 어떤 예외 타입을 지정해도 된다!(바운드 타입 토큰)</li>
    </ul>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Sample2</span> <span class="o">{</span>
    <span class="c1">// 매개변수로 클래스 리터럴을 받는 주석!</span>
    <span class="nd">@ExceptionTest</span><span class="o">(</span><span class="nc">ArithmeticException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">m1</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// 예외 발생하므로 성공하는 테스트</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">/</span> <span class="n">i</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@ExceptionTest</span><span class="o">(</span><span class="nc">ArithmeticException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">m2</span><span class="o">()</span> <span class="o">{</span> 
        <span class="c1">// 잘못된 Exception 으로 실패하는 테스트</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">a</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="nd">@ExceptionTest</span><span class="o">(</span><span class="nc">ArithmeticException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">m3</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span> <span class="c1">// 예외가 발생 안하므로 실패하는 테스트</span>

    <span class="nd">@ExceptionTest</span><span class="o">({</span> <span class="nc">IndexOutOfBoundsException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
            <span class="nc">NullPointerException</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">doublyBad</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>

        <span class="c1">// IndexOutOfBoundsException or NullPointerException 에러 발생</span>
        <span class="n">list</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>Test Annotation 처리</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RunTests</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">tests</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">passed</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="nc">Class</span> <span class="n">testClass</span> <span class="o">=</span> <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Method</span> <span class="n">m</span> <span class="o">:</span> <span class="n">testClass</span><span class="o">.</span><span class="na">getDeclaredMethods</span><span class="o">())</span> <span class="o">{</span>
            <span class="c1">// Test Annotation 이 적용된것만 테스트!</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">isAnnotationPresent</span><span class="o">(</span><span class="nc">Test</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">tests</span><span class="o">++;</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="n">m</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
                    <span class="n">passed</span><span class="o">++;</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InvocationTargetException</span> <span class="n">wrappedExc</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">Throwable</span> <span class="n">exc</span> <span class="o">=</span> <span class="n">wrappedExc</span><span class="o">.</span><span class="na">getCause</span><span class="o">();</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">m</span> <span class="o">+</span> <span class="s">" failed: "</span> <span class="o">+</span> <span class="n">exc</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">exc</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"INVALID @Test: "</span> <span class="o">+</span> <span class="n">m</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
            
            <span class="c1">// 만약에 Exception Annotation 이라면</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">isAnnotationPresent</span><span class="o">(</span><span class="nc">ExceptionTest</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">tests</span><span class="o">++;</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="n">m</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Test %s failed: no exception%n"</span><span class="o">,</span> <span class="n">m</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Throwable</span> <span class="n">wrappedExc</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">Throwable</span> <span class="n">exc</span> <span class="o">=</span> <span class="n">wrappedExc</span><span class="o">.</span><span class="na">getCause</span><span class="o">();</span>
                    
                    <span class="c1">// 가능한 예외 목록을 처리</span>
                    <span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Exception</span><span class="o">&gt;[]</span> <span class="n">excTypes</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="na">getAnnotation</span><span class="o">(</span>
                            <span class="nc">ExceptionTest</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">value</span><span class="o">();</span>
                    <span class="kt">int</span> <span class="n">oldPassed</span> <span class="o">=</span> <span class="n">passed</span><span class="o">;</span>
                    <span class="c1">// 여러개의 타입을 받는것을 처리</span>
                    <span class="k">for</span> <span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Exception</span><span class="o">&gt;</span> <span class="n">excType</span> <span class="o">:</span> <span class="n">excTypes</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">if</span> <span class="o">(</span><span class="n">excType</span><span class="o">.</span><span class="na">isInstance</span><span class="o">(</span><span class="n">exc</span><span class="o">))</span> <span class="o">{</span>
                            <span class="n">passed</span><span class="o">++;</span>
                            <span class="k">break</span><span class="o">;</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">passed</span> <span class="o">==</span> <span class="n">oldPassed</span><span class="o">)</span>
                        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Test %s failed: %s %n"</span><span class="o">,</span> <span class="n">m</span><span class="o">,</span> <span class="n">exc</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Passed: %d, Failed: %d%n"</span><span class="o">,</span> <span class="n">passed</span><span class="o">,</span> <span class="n">tests</span> <span class="o">-</span> <span class="n">passed</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<h3 id="item36--어노테이션은-일관되게-사용하라">ITEM36 : 어노테이션은 일관되게 사용하라</h3>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Bigram</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">char</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">char</span> <span class="n">second</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Bigram</span><span class="o">(</span><span class="kt">char</span> <span class="n">first</span><span class="o">,</span> <span class="kt">char</span> <span class="n">second</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="nc">Bigram</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="na">first</span> <span class="o">==</span> <span class="n">first</span> <span class="o">&amp;&amp;</span> <span class="n">b</span><span class="o">.</span><span class="na">second</span> <span class="o">==</span> <span class="n">second</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">31</span> <span class="o">*</span> <span class="n">first</span> <span class="o">+</span> <span class="n">second</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Bigram</span><span class="o">&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">Bigram</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">ch</span> <span class="o">=</span> <span class="sc">'a'</span><span class="o">;</span> <span class="n">ch</span> <span class="o">&lt;=</span> <span class="sc">'z'</span><span class="o">;</span> <span class="n">ch</span><span class="o">++)</span>
                <span class="n">s</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Bigram</span><span class="o">(</span><span class="n">ch</span><span class="o">,</span> <span class="n">ch</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>26 개의 바이그램을 10번 반복해서 Set 에 추가함! 정상적이라면 26 을 출력해야 한다! 하지만 모든 오브젝트가 다르게 인식되어서 260개가 출력됨
    <ul>
      <li>Bigram 클래스 개발자는 equals 를 오버라이딩을 하려 했다 하지만 <em>eqauls(Object b)</em> 가 되어야 하는데 잘못 오버라이딩 해주었다.</li>
      <li><em>@Override</em> 주석을 eauls 함수에 넣어주면 컴파일 에러가 발생해서 실수를 방지할수 있다.</li>
    </ul>
  </li>
</ul>

<h3 id="item37--자료형을-정의할-때-표식-인터페이스를-사용하라">ITEM37 : 자료형을 정의할 때 표식 인터페이스를 사용하라</h3>
<ul>
  <li>표시 인터페이스(marker interface)는 메소드 선언은 전혀없으면서 클래스가 그 인터페이스를 구현하는지만 나타내는(표시하는) 인터페이스이다.
    <ul>
      <li>ex) <em>Serializable</em></li>
    </ul>
  </li>
  <li>표시 인터페이스는 주석에 비해 2가지 장점이 있다.
    <ul>
      <li>표시된 클래스의 인스턴스에 의해 구현되는 타입을 정의한다. 타입이 있기때문에 주석이 런타입에서 에러를 잡을수 있을것을 컴파일 시점에서 할수 있다.
        <ul>
          <li><em>Serialzable</em> 의 <em>ObjectOutputStream.write(Object)</em> 함수는 <em>Serialzable</em> 을 메소드 인자 타입으로 이용하지 않고 <em>Object</em> 를 이용했다. 따라서 컴파일 시점이 아닌 런타임에서 오류가 나도록 잘못 설계가 되어있다.</li>
        </ul>
      </li>
      <li>더 정확한 목표를 가실수 있다는 장점이있다. 주석타입이 어떤 목표로 선언된다면 그 주석은 어떤 클래스나 인터페이스에도 적용할수 있게 된다. 표시 인터페이스를 정의하면 그것을 적용 가능한 인터페이스로 확장할수 있고 모든 표시 타입들도 그적용 가능한 인터페이스의 서브 타입이 되도록 할수 있다.</li>
    </ul>
  </li>
  <li><em>Set</em> 인터페이스는 <strong>제한적 표시 인터페이스</strong> 이다. 
___</li>
  <li>주석이 표시 인터페이스에 비해 갖는 장점
    <ul>
      <li>하나 이상의 주석 타입 요소들을 추가함으로써 더 많은 정보를 주석타입에 추가할수 있다!</li>
    </ul>
  </li>
  <li>클래스나 인터페이스가 아닌 다른 포로그램 요소에 적용할 때는 주석을 사용해야 한다.</li>
  <li>
    <p>클래스와 인터페이스에만 적용하되 표시자를 갖는 개체만을 인자로 받는 메소드를 하나 이상작성하지 않는다면 그표시자를 영원히 특정 인터페이스의 요소에만 제한해서 사용할 것인지 고려해 봐야한다. 그렇다면 인터페이스의 서브 인터페이스로 표시인터페이스를 정의하는 것이 좋다</p>
  </li>
  <li>정의할 타입과 연관된 어떤 새로운 메소드도 갖지 않는 타입을 정의하고자 한다면 표시 인터페이스</li>
  <li>클래스와 인터페이스가 아닌 다른 프로그램 요소를 표시한다면, 향후에 더많은 정볼르 표시자에 추가할 가능성이 있다면 표시 주석!</li>
</ul>


  </article>

  <!-- Twitter -->
<span class="post-sharing">
  <a href="https://twitter.com/share" class="twitter-share-button" data-size="large">Tweet</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</span>



<!-- Reddit -->
<span class="post-sharing" style="margin-right: 32px">
  <script type="text/javascript" src="//www.redditstatic.com/button/button1.js"></script>
</span>
<!-- Facebook -->
<span class="post-sharing">
  <div class="fb-share-button" data-href="http://rangken.github.io/blog/2015/effective-java-5/" data-layout="button" style="width: 70px;"></div>
</span>


  <div>
		

    

    
    	<div class="post-related">
			Related: <a href="/blog/2015/effective-java-4/">Effective Java 5장 제네릭</a>
        </div>
    
</div>

  <div class="fb-comments" data-href="http://rangken.github.io/blog/2015/effective-java-5/" data-numposts="5" data-colorscheme="light" data-width="750"></div>


</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Young.k</li>
          <li><a href="mailto:rangken@gmail.com">rangken@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/rangken" target="_blank">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">rangken</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/rangken87" target="_blank">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">rangken87</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
      <!-- footer desctiption <p class="text"></p> -->
      Powered by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a> & <a href="http://jekyllrb.com/" target="_blank">Jekyll</a>
      </div>
    </div>

  </div>
  <div id="fb-root"></div>
</footer>


  </body>

</html>
